(()=>{var e={};e.id=500,e.ids=[500],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},887:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>l,routeModule:()=>f,tree:()=>d});var a=r(482),s=r(9108),o=r(2563),n=r.n(o),i=r(8300),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);r.d(t,c);let d=["",{children:["host",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,3835)),"C:\\Users\\eomis\\CascadeProjects\\black-envelope-masquerade\\src\\app\\host\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,1342)),"C:\\Users\\eomis\\CascadeProjects\\black-envelope-masquerade\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9361,23)),"next/dist/client/components/not-found-error"]}],l=["C:\\Users\\eomis\\CascadeProjects\\black-envelope-masquerade\\src\\app\\host\\page.tsx"],u="/host/page",m={require:r,loadChunk:()=>Promise.resolve()},f=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/host/page",pathname:"/host",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},5372:(e,t,r)=>{let a={"0036fe03d9fd9a23536c862ebf094439a01b91c2":()=>Promise.resolve().then(r.bind(r,9809)).then(e=>e.submitNumber),"073ce1767dcee64b2fc630df8e98e642631d3a29":()=>Promise.resolve().then(r.bind(r,9809)).then(e=>e.restartGame),"08e9cf0c01117b3e4e143dc5715de55c768d93d7":()=>Promise.resolve().then(r.bind(r,9809)).then(e=>e.joinRoom),"6533112c9a26bbd6e38efa2ebcd06f7fce005398":()=>Promise.resolve().then(r.bind(r,9809)).then(e=>e.revealResults),"7a9d60296671b80f99ee80e54f5ceb4695f3bd09":()=>Promise.resolve().then(r.bind(r,9809)).then(e=>e.createRoom),f972cc93aaa8e5e619e1da89ffcb6130f9d9a302:()=>Promise.resolve().then(r.bind(r,9809)).then(e=>e.getRoomData)};async function s(e,...t){return(await a[e]()).apply(null,t)}e.exports={"0036fe03d9fd9a23536c862ebf094439a01b91c2":s.bind(null,"0036fe03d9fd9a23536c862ebf094439a01b91c2"),"073ce1767dcee64b2fc630df8e98e642631d3a29":s.bind(null,"073ce1767dcee64b2fc630df8e98e642631d3a29"),"08e9cf0c01117b3e4e143dc5715de55c768d93d7":s.bind(null,"08e9cf0c01117b3e4e143dc5715de55c768d93d7"),"6533112c9a26bbd6e38efa2ebcd06f7fce005398":s.bind(null,"6533112c9a26bbd6e38efa2ebcd06f7fce005398"),"7a9d60296671b80f99ee80e54f5ceb4695f3bd09":s.bind(null,"7a9d60296671b80f99ee80e54f5ceb4695f3bd09"),f972cc93aaa8e5e619e1da89ffcb6130f9d9a302:s.bind(null,"f972cc93aaa8e5e619e1da89ffcb6130f9d9a302")}},3155:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2583,23)),Promise.resolve().then(r.t.bind(r,6840,23)),Promise.resolve().then(r.t.bind(r,8771,23)),Promise.resolve().then(r.t.bind(r,3225,23)),Promise.resolve().then(r.t.bind(r,9295,23)),Promise.resolve().then(r.t.bind(r,3982,23))},166:()=>{},2219:(e,t,r)=>{Promise.resolve().then(r.bind(r,876))},876:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var a=r(5344),s=r(3729),o=r(8428),n=r(7916),i=r(9e3),c=r(4781);function d(){let e=(0,o.useRouter)(),[t,r]=(0,s.useState)(!1),[d,l]=(0,s.useState)(""),u=async()=>{r(!0),l("");try{let t=new Promise((e,t)=>setTimeout(()=>t(Error("Network timeout - try again")),15e3)),a=await Promise.race([(0,i.dB)(),t]);a.success&&a.code&&a.hostToken?(sessionStorage.setItem(`host_${a.code}`,a.hostToken),e.push(`/room/${a.code}`)):(l(a.error||"Failed to create room"),r(!1))}catch(e){l(e.message||"Network error - check your connection"),r(!1)}};return(0,a.jsxs)("main",{className:"relative min-h-screen flex flex-col items-center justify-center px-4",children:[a.jsx(c.Z,{count:30}),a.jsx("div",{className:"absolute inset-0 z-0",style:{background:"radial-gradient(ellipse at center, rgba(212,175,55,0.04) 0%, transparent 60%)"}}),(0,a.jsxs)(n.E.div,{className:"relative z-10 w-full max-w-md text-center",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,ease:[.16,1,.3,1]},children:[a.jsx("h1",{className:"font-serif text-3xl md:text-4xl text-gold mb-3",children:"Host a Masquerade"}),a.jsx("p",{className:"text-white/40 font-sans text-sm mb-10",children:"Create a room and invite players to join your game."}),d&&a.jsx(n.E.p,{initial:{opacity:0},animate:{opacity:1},className:"text-red-400 text-sm mb-4 font-sans",children:d}),a.jsx(n.E.button,{onClick:u,disabled:t,className:"w-full px-8 py-4 bg-transparent border border-gold text-gold font-sans font-medium text-base rounded-sm transition-all duration-300 hover:bg-gold/10 hover:shadow-[0_0_30px_rgba(212,175,55,0.3)] disabled:opacity-50 disabled:cursor-not-allowed",whileTap:{scale:.98},children:t?(0,a.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[a.jsx("span",{className:"w-4 h-4 border-2 border-gold/40 border-t-gold rounded-full animate-spin"}),"Creating..."]}):"Create Room"}),a.jsx("button",{onClick:()=>e.push("/"),className:"mt-6 text-gold/40 text-sm font-sans hover:text-gold/60 transition-colors",children:"← Back"})]})]})}},4781:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var a=r(5344),s=r(3729),o=r(7916);function n({count:e=40}){let[t,r]=(0,s.useState)([]);return(0,s.useEffect)(()=>{let t=[];for(let r=0;r<e;r++)t.push({id:r,x:100*Math.random(),y:100*Math.random(),size:3*Math.random()+1,duration:8*Math.random()+6,delay:5*Math.random(),opacity:.5*Math.random()+.1});r(t)},[e]),a.jsx("div",{className:"fixed inset-0 pointer-events-none overflow-hidden z-0",children:t.map(e=>a.jsx(o.E.div,{className:"absolute rounded-full",style:{left:`${e.x}%`,top:`${e.y}%`,width:e.size,height:e.size,backgroundColor:"#D4AF37"},animate:{y:[0,-30,0],x:[0,20*Math.random()-10,0],opacity:[e.opacity,1.5*e.opacity,e.opacity]},transition:{duration:e.duration,delay:e.delay,repeat:1/0,ease:"easeInOut"}},e.id))})}},9e3:(e,t,r)=>{"use strict";r.d(t,{BM:()=>d,Gi:()=>s,Ls:()=>n,dB:()=>o,it:()=>i,jJ:()=>c}),r(3664);var a=r(8371),s=(0,a.$)("f972cc93aaa8e5e619e1da89ffcb6130f9d9a302"),o=(0,a.$)("7a9d60296671b80f99ee80e54f5ceb4695f3bd09"),n=(0,a.$)("08e9cf0c01117b3e4e143dc5715de55c768d93d7"),i=(0,a.$)("0036fe03d9fd9a23536c862ebf094439a01b91c2"),c=(0,a.$)("6533112c9a26bbd6e38efa2ebcd06f7fce005398"),d=(0,a.$)("073ce1767dcee64b2fc630df8e98e642631d3a29")},3835:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>o,__esModule:()=>s,default:()=>n});let a=(0,r(6843).createProxy)(String.raw`C:\Users\eomis\CascadeProjects\black-envelope-masquerade\src\app\host\page.tsx`),{__esModule:s,$$typeof:o}=a,n=a.default},1342:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o,metadata:()=>s});var a=r(5036);r(5023);let s={title:"The Black Envelope Masquerade — The Consensus",description:"An elegant multiplayer strategy game. Guess 2/3 of the average to win."};function o({children:e}){return a.jsx("html",{lang:"en",children:a.jsx("body",{className:"antialiased",children:e})})}},9809:(e,t,r)=>{"use strict";r.r(t),r.d(t,{createRoom:()=>n,getRoomData:()=>u,joinRoom:()=>i,restartGame:()=>l,revealResults:()=>d,submitNumber:()=>c});var a=r(8601);r(5811);var s=r(3948);function o(){let e="ABCDEFGHJKLMNPQRSTUVWXYZ23456789",t="";for(let r=0;r<6;r++)t+=e[Math.floor(Math.random()*e.length)];return t}async function n(){try{let e=o(),t=0;for(;t<10;){let{data:r}=await (0,s.getSupabaseAdmin)().from("rooms").select("id").eq("code",e).single();if(!r)break;e=o(),t++}let r=function(){let e="abcdefghijklmnopqrstuvwxyz0123456789",t="";for(let r=0;r<32;r++)t+=e[Math.floor(Math.random()*e.length)];return t}(),{error:a}=await (0,s.getSupabaseAdmin)().from("rooms").insert({code:e,status:"waiting",host_token:r});if(a)throw a;return{success:!0,code:e,hostToken:r}}catch(t){let e=t instanceof Error?t.message:"object"==typeof t&&null!==t&&"message"in t?String(t.message):"Failed to create room";return console.error("[createRoom]",t),{success:!1,error:e}}}async function i(e,t){try{let r=e.trim().toUpperCase(),a=t.trim();if(!r||6!==r.length)return{success:!1,error:"Invalid room code"};if(!a||a.length<1||a.length>30)return{success:!1,error:"Name must be 1-30 characters"};let{data:o,error:n}=await (0,s.getSupabaseAdmin)().from("rooms").select("id, status").eq("code",r).single();if(n||!o)return{success:!1,error:"Room not found"};if("revealed"===o.status)return{success:!1,error:"Game already ended"};let{data:i}=await (0,s.getSupabaseAdmin)().from("players").select("id").eq("room_id",o.id).eq("name",a).single();if(i)return{success:!1,error:"Name already taken in this room"};let{data:c,error:d}=await (0,s.getSupabaseAdmin)().from("players").insert({room_id:o.id,name:a,number:null}).select("id").single();if(d||!c)throw d||Error("Failed to join room");return{success:!0,playerId:c.id,roomId:o.id}}catch(t){let e=t instanceof Error?t.message:"object"==typeof t&&null!==t&&"message"in t?String(t.message):"Failed to join room";return console.error("[joinRoom]",t),{success:!1,error:e}}}async function c(e,t){try{if(!Number.isInteger(t)||t<1||t>100)return{success:!1,error:"Number must be between 1 and 100"};let{data:r}=await (0,s.getSupabaseAdmin)().from("players").select("id, number").eq("id",e).single();if(!r)return{success:!1,error:"Player not found"};if(null!==r.number)return{success:!1,error:"Already submitted"};let{error:a}=await (0,s.getSupabaseAdmin)().from("players").update({number:t}).eq("id",e);if(a)throw a;return{success:!0}}catch(t){let e=t instanceof Error?t.message:"object"==typeof t&&null!==t&&"message"in t?String(t.message):"Failed to submit";return console.error("[submitNumber]",t),{success:!1,error:e}}}async function d(e,t){try{let{data:r}=await (0,s.getSupabaseAdmin)().from("rooms").select("id, host_token, status").eq("code",e).single();if(!r)return{success:!1,error:"Room not found"};if(r.host_token!==t)return{success:!1,error:"Unauthorized"};if("revealed"===r.status)return{success:!1,error:"Already revealed"};let{data:a}=await (0,s.getSupabaseAdmin)().from("players").select("*").eq("room_id",r.id);if(!a||a.length<3)return{success:!1,error:"Need at least 3 players"};if(!a.every(e=>null!==e.number))return{success:!1,error:"Not all players have submitted"};let{error:o}=await (0,s.getSupabaseAdmin)().from("rooms").update({status:"revealed"}).eq("id",r.id);if(o)throw o;return{success:!0}}catch(t){let e=t instanceof Error?t.message:"object"==typeof t&&null!==t&&"message"in t?String(t.message):"Failed to reveal";return console.error("[revealResults]",t),{success:!1,error:e}}}async function l(e,t){try{let{data:r}=await (0,s.getSupabaseAdmin)().from("rooms").select("id, host_token").eq("code",e).single();if(!r)return{success:!1,error:"Room not found"};if(r.host_token!==t)return{success:!1,error:"Unauthorized"};await (0,s.getSupabaseAdmin)().from("players").delete().eq("room_id",r.id);let{error:a}=await (0,s.getSupabaseAdmin)().from("rooms").update({status:"waiting"}).eq("id",r.id);if(a)throw a;return{success:!0}}catch(t){let e=t instanceof Error?t.message:"object"==typeof t&&null!==t&&"message"in t?String(t.message):"Failed to restart";return console.error("[restartGame]",t),{success:!1,error:e}}}async function u(e){let{data:t}=await (0,s.getSupabaseAdmin)().from("rooms").select("*").eq("code",e).single();if(!t)return null;let{data:r}=await (0,s.getSupabaseAdmin)().from("players").select("*").eq("room_id",t.id).order("created_at",{ascending:!0});return{room:t,players:r||[]}}(0,r(6893).ensureServerEntryExports)([n,i,c,d,l,u]),(0,a.createActionProxy)("7a9d60296671b80f99ee80e54f5ceb4695f3bd09",n),(0,a.createActionProxy)("08e9cf0c01117b3e4e143dc5715de55c768d93d7",i),(0,a.createActionProxy)("0036fe03d9fd9a23536c862ebf094439a01b91c2",c),(0,a.createActionProxy)("6533112c9a26bbd6e38efa2ebcd06f7fce005398",d),(0,a.createActionProxy)("073ce1767dcee64b2fc630df8e98e642631d3a29",l),(0,a.createActionProxy)("f972cc93aaa8e5e619e1da89ffcb6130f9d9a302",u)},3948:(e,t,r)=>{"use strict";r.d(t,{getSupabaseAdmin:()=>o});var a=r(3611);let s=null;function o(){if("phase-production-build"===process.env.NEXT_PHASE)throw Error("Supabase not available during build");if(!s){let e="https://oosfxoyookeouemxdejz.supabase.co",t=process.env.SUPABASE_SERVICE_ROLE_KEY||"";(!e||e.startsWith("your_"))&&console.warn("[Supabase] NEXT_PUBLIC_SUPABASE_URL is not configured"),(!t||t.startsWith("your_")||""===t)&&console.warn("[Supabase] SUPABASE_SERVICE_ROLE_KEY is not configured"),s=(0,a.createClient)(e,t)}return s}},5023:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[22,916,859],()=>r(887));module.exports=a})();